import{d as c}from"./pinia-D1tb24LR.js";import{a as m}from"./axios-Di5RpEPX.js";import{s as p}from"./sweetalert2-WZH64N0g.js";import{M as h}from"./bootstrap-fL-MoaV8.js";import{aR as d,a5 as n,a6 as t,aI as u,bz as g,bq as _}from"./@vue-Cqo5QHyB.js";import{_ as f}from"./index-D-46vVS1.js";var b={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/test/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:I,VITE_PATH:v}=b,Q=c("adminProducts",{state:()=>({allProducts:[],groupList:[]}),actions:{getAllProducts(){const s=`${I}/api/${v}/admin/products/all`;return m.get(s).then(e=>{this.allProducts=e.data.products,this.getGroupList()}).catch(e=>{p.fire({icon:"error",text:e.response.data.message})})},getGroupList(){const s=Object.values(this.allProducts),e=new Set(s.map(o=>o.group));this.groupList=[...e]}}});var U={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/test/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:A,VITE_PATH:M}=U,x={props:["isCover"],data(){return{modal:null,accept:["jpg","jpeg","png"],imgUrl:""}},methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()},handleFile(s){const e=s.target.files[0];if(e.size/(1024*1024)>3)return this.$swal.fire({icon:"error",text:"請上傳 3MB 以內的圖檔"}),this.resetDropArea(),!1;const a=e.type.split("/")[1];if(!this.accept.find(i=>i===a))return this.$swal.fire({icon:"error",text:"僅限使用 jpg、jpeg 與 png 格式圖檔"}),this.resetDropArea(),!1;this.uploadImage(e)},uploadImage(s){const e=this.$loading.show(),o=new FormData;o.append("file-to-upload",s),this.axios.post(`${A}/api/${M}/admin/upload`,o).then(l=>{this.imgUrl=l.data.imageUrl}).catch(l=>{this.$swal.fire({icon:"error",text:l.response})}).finally(()=>{e.hide()})},resetDropArea(){this.imgUrl="",this.$refs.dropArea.value=""},submitImgUrl(){this.isCover?this.$emit("submitImgUrl","imageUrl",this.imgUrl):this.$emit("submitImgUrl","imagesUrl",this.imgUrl),this.resetDropArea(),this.closeModal()}},mounted(){this.modal=new h(this.$refs.uploadImageModal,{keyboard:!1,backdrop:"static"})}},T={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true","aria-labelledby":"uploadImageModal",tabindex:"-1"},y={class:"modal-dialog modal-lg modal-dialog-centered"},P={class:"modal-content"},E={class:"modal-header"},w={key:0,class:"modal-title text-bold fw-bold"},S={key:1,class:"modal-title text-bold fw-bold"},V=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body container"},k={class:"row g-3"},B={class:"col-12 col-md-4"},$={class:"drop-area ratio-1x1"},j={key:1},z={class:"col-12 col-md-8"},L=t("p",{class:"mb-1"},"僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下",-1),R={ref:"imgForm"},C=["accept"],F={class:"modal-footer"};function H(s,e,o,l,a,r){return d(),n("div",T,[t("div",y,[t("div",P,[t("div",E,[o.isCover?(d(),n("h5",w,"上傳封面")):(d(),n("h5",S,"上傳圖片")),V]),t("div",D,[t("div",k,[t("div",B,[t("div",$,[a.imgUrl?(d(),n("div",{key:0,style:u(`background-image:url(${a.imgUrl})`),class:"w-100 h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)):(d(),n("p",j,"圖片預覽"))])]),t("div",z,[L,t("form",R,[g(t("input",{class:"form-control mb-1",type:"text",placeholder:"請填入圖片網址","onUpdate:modelValue":e[0]||(e[0]=i=>a.imgUrl=i)},null,512),[[_,a.imgUrl]]),t("input",{class:"form-control",type:"file",ref:"dropArea",accept:a.accept,onChange:e[1]||(e[1]=(...i)=>r.handleFile&&r.handleFile(...i))},null,40,C)],512)])])]),t("div",F,[t("button",{type:"button",class:"btn btn-dark",onClick:e[2]||(e[2]=(...i)=>r.submitImgUrl&&r.submitImgUrl(...i))},"送出")])])])],512)}const W=f(x,[["render",H]]);export{W as U,Q as u};
