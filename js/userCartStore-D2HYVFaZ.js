import{d as p}from"./pinia-Cz9d2yny.js";import{a as c}from"./axios-Di5RpEPX.js";import{s as n}from"./sweetalert2-WZH64N0g.js";import{d as u}from"./vue-loading-overlay-DxSJf-C0.js";const i=p("statusStore",{state:()=>({toastMsgList:[],message:{}}),actions:{addMsg(t="bi-info-circle",s=""){this.message={icon:t,msg:s},this.handleMsg()},handleMsg(){this.toastMsgList.unshift(this.message),setTimeout(()=>{this.toastMsgList.pop()},1500)},clearMsg(t){this.toastMsgList.splice(t,1)}}});var f={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/test/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=u.useLoading(),{VITE_API:h,VITE_PATH:l}=f,_=p("cartStore",{state:()=>({cartsList:[],coupon_code:""}),actions:{addToCart(t,s){const o=d.show(),a=`${h}/api/${l}/cart`,e={data:{product_id:t,qty:s}};c.post(a,e).then(r=>{const{addMsg:g}=i();g("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(r=>{n.fire({icon:"error",text:r.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{o.hide()})},getCartsList(){const t=d.show(),s=`${h}/api/${l}/cart`;return c.get(s).then(o=>{this.cartsList=o.data.data}).catch(o=>{n.fire({icon:"error",text:o.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{t.hide()})},updateCart(t){const s=d.show(),o=`${h}/api/${l}/cart/${t.id}`,a={data:{product_id:t.product_id,qty:t.qty}};c.put(o,a).then(e=>{const{addMsg:r}=i();r("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(e=>{n.fire({icon:"error",text:e.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{s.hide()})},deleteCartItem(t){const s=d.show(),o=`${h}/api/${l}/cart/${t}`;c.delete(o).then(a=>{const{addMsg:e}=i();e("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(a=>{n.fire({icon:"error",text:a.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{s.hide()})},copyCouponCode(t){navigator.clipboard.writeText(t).then(()=>{const{addMsg:s}=i();s("bi-info-circle","已複製優惠碼"),this.coupon_code=t})},checkCoupon(t){const s=`${h}/api/${l}/coupon`;if(this.cartsList.total!==this.cartsList.final_total){const{addMsg:e}=i();e("bi-info-circle","已套用優惠碼");return}const o=d.show(),a={data:{code:t}};c.post(s,a).then(e=>{const{addMsg:r}=i();r("bi-info-circle","已套用優惠碼"),this.getCartsList()}).catch(e=>{n.fire({icon:"error",text:e.response.data.message})}).finally(()=>{o.hide()})}}});export{_ as c,i as s};
